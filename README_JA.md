# 産業用グレード Web3 イベントインデクサー

[🌐 **English**](./README.md) | [🏮 **中文说明**](./README_ZH.md) | [🗾 **日本語の説明**](./README_JA.md)

### 🚀 ライブデモ
*   **本番環境 (Sepolia)**: [https://demo1.st6160.click/](https://demo1.st6160.click/)
*   **ローカルラボ (Anvil)**: [https://demo2.st6160.click/](https://demo2.st6160.click/)
*   **開発ジャーニー**: [10日間の開発ログを読む](./DEVELOPMENT_JA.md) 🚀

**Go**、**PostgreSQL**、および **Docker** で構築された、極めて高い信頼性とコスト効率を誇るイーサリアムイベントインデクサーです。インフラ運用負担を最小限に抑えながら、本番グレードのブロックチェーンデータパイプラインを必要とするチーム向けに設計されています。

## 💼 ビジネス価値

*   **RPC コストを 70% 以上削減**：**重み付きトークンバケット** 流量制限アルゴリズムを搭載し、Alchemy/Infura の無料枠を最大限に活用（メイン/バックアップ比率 3:1）。本番環境で 3.5 RPS を持続的に維持し、レート制限に達しないことを検証済み。
*   **ダウンタイムをゼロに**：**ブルーグリーンデプロイ** ワークフローにより、2 秒未満の切り替えでゼロダウンタイムリリースを実現。収益に影響するシステムにとって不可欠です。
*   **レート制限から自動復旧**：**429 サーキットブレーカー** がプロバイダーのスロットリングを検知し、5 分間の冷却期間と自動フェイルオーバーを実行。人手を必要としません。
*   **高コストなデータ汚染を防止**：起動時の **NetworkID/ChainID 強制検証** により、環境間のデータベース汚染を物理的に排除——数時間のデバッグ時間を節約し、潜在的な財務エラーを防ぎます。
*   **低活動期でもリアルタイム UI を維持**：**効率的なレンジスキャン** と 50 ブロック一括処理、Keep-alive プログレス機構により、チェーン上のイベントが少ない期間でもダッシュボードがリアルタイムに更新されます。
*   **コールドスタートを排除**：**Early-Bird API モード** で Web サーバーの起動をエンジン初期化から分離——ミリ秒単位でポートを開放し、デプロイ時のロードバランサー 502 エラーを完全に排除します。

## 🛠️ 技術スタック

*   **バックエンド**: Go (Golang) + `go-ethereum`
*   **インフラ**: Docker（マルチ環境の分離）
*   **データベース**: PostgreSQL（各インスタンスに独立した物理データベースを割り当て）
*   **オブザーバビリティ**: Prometheus + Grafana（マルチ環境対応ダッシュボード）

## 📦 本番デプロイ

ブルーグリーンデプロイワークフローにより、リリースの安定性を確保します：

1.  **テスト (Test)**: `make test-a1` (Sepolia) または `make test-a2` (Anvil) を使用して Staging にデプロイ。
2.  **検証 (Verify)**: Staging で動作確認を実施。
3.  **昇格 (Promote)**: `make a1` または `make a2` を実行し、イメージを本番環境に瞬間的に反映。
    *   *仕組み*: `docker tag :latest -> :stable` + `docker compose up -d --no-build`

## 📈 パフォーマンス指標

| モード | 対象ネットワーク | RPS 制限 | 遅延 | コスト戦略 |
| :--- | :--- | :--- | :--- | :--- |
| **安定版 (Stable)** | Sepolia (テストネット) | 3.5 RPS | ~12s | 重み付きマルチ RPC（無料枠最適化） |
| **デモ版 (Demo)** | Anvil (ローカル) | 10000+ RPS | < 1s | 制限解除モード（開発用） |
| **デバッグ版 (Debug)** | Sepolia (テストネット) | 5.0 RPS | ~12s | 商用 RPC 直結（トラブルシューティング用） |

## 🔐 セキュリティとデータ完全性

*   **チェーン ID 検証**: 起動時に強制実行され、環境設定ミスを防止
*   **API レスポンス署名**: すべてのレスポンスは **Ed25519** で署名され、エンドツーエンドの完全性検証に対応
*   **物理的分離**: Docker ベースの環境分離によりデータ漏洩を防止

---

*MIT ライセンス — 本番商用デプロイメント対応*
