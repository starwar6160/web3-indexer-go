# Demo æ¼”ç¤ºæŒ‡å— (v2.2.0-stable)

## ğŸ“‹ æ¼”ç¤ºå‰æ£€æŸ¥æ¸…å•

### ç¯å¢ƒå‡†å¤‡
```bash
# 1. ç¡®è®¤å®¹å™¨è¿è¡Œ
docker ps | grep web3-demo2-app

# 2. ç¡®è®¤ç«¯å£å¼€æ”¾
curl http://localhost:8082/api/status | jq '.system_state'

# 3. ç¡®è®¤ Anvil è¿æ¥
docker logs web3-demo2-app --tail 20 | grep "Anvil"
```

### é»„é‡‘é…ç½®
```bash
# å¦‚éœ€æ¢å¤åˆ°é»„é‡‘é…ç½®
cp configs/env/config.demo.golden.env configs/env/.env.demo2
make a2
```

---

## ğŸ­ æ¼”ç¤ºè„šæœ¬

### å¼€åœºç™½ (30 ç§’)

> "è¿™æ˜¯æˆ‘ä¸º Web3 åŒºå—é“¾ç´¢å¼•å™¨è®¾è®¡çš„ç”Ÿäº§çº§ç³»ç»Ÿã€‚
> 
> **æ ¸å¿ƒç†å¿µ**ï¼šè¿½æ±‚ 6 ä¸ª 9 çš„æŒä¹…æ€§ï¼ˆ99.9999%ï¼‰ï¼Œé‡‡ç”¨ Small Increments + Atomic Verification çš„å·¥ç¨‹æ–¹æ³•ã€‚
> 
> **å½“å‰ç¯å¢ƒ**ï¼šæœ¬åœ° Anvil æµ‹è¯•ç½‘ï¼Œä»åˆ›ä¸–å—ï¼ˆå— 0ï¼‰å¼€å§‹å®æ—¶åŒæ­¥ã€‚
> 
> æ‚¨å¯ä»¥çœ‹åˆ° [UI ç•Œé¢]ï¼Œé¡¶éƒ¨æ˜¾ç¤ºåŒæ­¥è¿›åº¦ç™¾åˆ†æ¯”ï¼Œå®æ—¶ TPSï¼Œä»¥åŠç³»ç»Ÿå¥åº·çŠ¶æ€ã€‚"

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¼”ç¤º

### 1. å®æ—¶åŒæ­¥æ€§èƒ½ (1 åˆ†é’Ÿ)

**æ“ä½œ**ï¼šæŒ‡å‘ UI é¡¶éƒ¨çš„åŒæ­¥è¿›åº¦

```
Total (Synced): [100% âœ…] (15700)
                â†‘ ç™¾åˆ†æ¯”    â†‘ ç»å¯¹æ•°å­—
```

**è¯æœ¯**ï¼š
> "ç³»ç»Ÿå·²å®Œæˆ 15700 ä¸ªåŒºå—çš„åŒæ­¥ã€‚
> 
> - **åŒæ­¥è¿›åº¦**ï¼š100%ï¼ˆç»¿è‰²âœ…è¡¨ç¤ºé¢†å…ˆäºé“¾ï¼‰
> - **å®æ—¶ TPS**ï¼š7.75ï¼ˆæ¯ç§’å¤„ç†çš„äº¤æ˜“æ•°ï¼‰
> - **Sync Lag**ï¼š0 å—ï¼ˆä¸é“¾é¡¶å®Œå…¨åŒæ­¥ï¼‰
> 
> æ‚¨å¯ä»¥çœ‹åˆ°æ‰€æœ‰æŒ‡æ ‡éƒ½æ˜¯å®æ—¶æ›´æ–°çš„ï¼Œé€šè¿‡ WebSocket æ¨é€åˆ°å‰ç«¯ã€‚"

**æŠ€æœ¯æ·±åº¦**ï¼š
- é‡‡ç”¨ WebSocket é•¿è¿æ¥ï¼ˆé¿å…è½®è¯¢å¼€é”€ï¼‰
- Prometheus æŒ‡æ ‡é‡‡é›†ï¼ˆå¯è§‚æµ‹æ€§ï¼‰
- é¢œè‰²ç¼–ç ï¼šç»¿/é»„/æ©™/çº¢ï¼ˆç›´è§‚çŠ¶æ€è¯†åˆ«ï¼‰

---

### 2. å¼‚å¸¸æ¢å¤æ¼”ç¤º â­ **é«˜å…‰æ—¶åˆ»** (2 åˆ†é’Ÿ)

**æ“ä½œ**ï¼š
```bash
# åœ¨æ–°ç»ˆç«¯æ‰§è¡Œ
docker restart web3-demo2-anvil
```

**é¢„æœŸè¡Œä¸º**ï¼š
1. æ—¥å¿—ç«‹å³æŠ¥é”™ï¼š`ğŸ›¡ï¸ DeadlockWatchdog: Chain reset detected`
2. UI åœ¨ 1 ç§’å†…é‡ç½®ä¸º 0
3. ç³»ç»Ÿç¬é—´å¼€å§‹é‡æ–°è„‰åŠ¨

**è¯æœ¯**ï¼š
> "ç°åœ¨æ¼”ç¤ºç³»ç»Ÿçš„**è‡ªæ„ˆèƒ½åŠ›**ã€‚
> 
> æˆ‘æ‰‹åŠ¨é‡å¯äº†åº•å±‚çš„ Anvil å®¹å™¨ï¼Œæ¨¡æ‹Ÿ**ç”Ÿäº§ç¯å¢ƒä¸­çš„åŒºå—é“¾èŠ‚ç‚¹æ•…éšœ**ã€‚
> 
> [è§‚å¯Ÿæ—¥å¿—]
> 
> æ‚¨å¯ä»¥çœ‹åˆ°ï¼š
> 1. **æ­»é”çœ‹é—¨ç‹—**åœ¨ 120 ç§’å†…æ£€æµ‹åˆ°é“¾æ–­è£‚
> 2. **ç‰©ç†çº§æ¸¸æ ‡å¼ºæ’**ï¼šæ•°æ®åº“æ°´ä½çº¿é‡ç½®
> 3. **çŠ¶æ€æœºçƒ­é‡å¯**ï¼šSequencer æœŸæœ›å—é‡ç½®
> 4. **æ¯«ç§’çº§å†·å¯åŠ¨**ï¼šä»å— 0 é‡æ–°å¼€å§‹åŒæ­¥
> 
> æ•´ä¸ªè¿‡ç¨‹**å®Œå…¨ä¸éœ€è¦äººå·¥å¹²é¢„**ï¼Œè¿™å°±æ˜¯ Strategy Pattern å¸¦æ¥çš„æ¶æ„ä¼˜åŠ¿ã€‚"

**æŠ€æœ¯äº®ç‚¹**ï¼š
- äºŒé˜¶çŠ¶æ€å®¡è®¡çœ‹é—¨ç‹—ï¼ˆSecond-order State Audit Watchdogï¼‰
- ç‹¬ç«‹åç¨‹ï¼š30 ç§’æ£€æŸ¥å‘¨æœŸï¼Œä¸å½±å“ä¸»æµç¨‹
- ä¸‰æ­¥è‡ªæ„ˆï¼šç‰©ç†çº§æ¸¸æ ‡å¼ºæ’ â†’ çŠ¶æ€æœºçƒ­é‡å¯ â†’ Buffer æ¸…ç†

---

### 3. å®šé¢‘æ€§èƒ½æ¼”ç¤º (1 åˆ†é’Ÿ)

**æ“ä½œ**ï¼šæŒ‡å‘ UI é¡¶éƒ¨çš„ TPS æŒ‡æ ‡

```
Real-time TPS: 7.75
Sync Lag:      0 blocks
```

**è¯æœ¯**ï¼š
> "åœ¨ 16GB å†…å­˜çš„å•æœºç¯å¢ƒä¸‹ï¼Œç³»ç»Ÿä¾ç„¶ä¿æŒäº†**æé«˜çš„å®šé¢‘æ€§èƒ½**ï¼ˆDeterministic Performanceï¼‰ã€‚
> 
> - **å®æ—¶ TPS**ï¼šç¨³å®šåœ¨ 7.75ï¼ˆæ— æŠ–åŠ¨ï¼‰
> - **Sync Lag**ï¼šå§‹ç»ˆä¿æŒ 0 å—ï¼ˆä¸é“¾é¡¶åŒæ­¥ï¼‰
> - **å†…å­˜ä½¿ç”¨**ï¼š< 128MBï¼ˆè¿œä½äº 16GB é™åˆ¶ï¼‰
> 
> è¿™æ˜¯é€šè¿‡ä»¥ä¸‹æŠ€æœ¯å®ç°çš„ï¼š
> 1. **æ»‘åŠ¨æ—¶é—´çª—å£æ‰¹å¤„ç†**ï¼ˆTailFollow æ¨¡å¼ï¼‰
> 2. **è¾¹ç•Œä¿æŠ¤**ï¼ˆé˜²æ­¢è°ƒåº¦è¶…å‡ºé“¾é¡¶ï¼‰
> 3. **Range Teleport**ï¼ˆæ‰¹é‡è¿›åº¦ä¿¡å·ï¼Œé¿å…é€å—å¤„ç†ï¼‰"

**æŠ€æœ¯æ·±åº¦**ï¼š
- 100ms è¶…é«˜é¢‘è°ƒåº¦ï¼ˆAnvil ä¸“ç”¨ï¼‰
- 100 å—æ»‘åŠ¨çª—å£ï¼ˆæ‰¹é‡æŠ“å–ï¼‰
- aggressiveTarget è¾¹ç•Œæ£€æŸ¥ï¼ˆä¸è¶…è¿‡ tipï¼‰

---

## ğŸ”§ æŠ€æœ¯é—®é¢˜åº”å¯¹

### Q1: "ä¸ºä»€ä¹ˆä¸ç”¨ Kafka/RabbitMQï¼Ÿ"

**å›ç­”**ï¼š
> "å¯¹äºå•æœºç´¢å¼•å™¨ï¼Œå¼•å…¥ MQ ä¼šå¢åŠ **æ¶æ„å¤æ‚åº¦**å’Œ**è¿ç»´æˆæœ¬**ã€‚
> 
> æˆ‘çš„ç³»ç»Ÿé€šè¿‡ **Channel + Buffer** å®ç°äº†åŒæ ·çš„è§£è€¦æ•ˆæœï¼š
> - Fetcher â†’ Sequencerï¼šresults channelï¼ˆå®¹é‡ 15000ï¼‰
> - Sequencer â†’ AsyncWriterï¼špersist channelï¼ˆå®¹é‡ 15000ï¼‰
> - èƒŒå‹ä¿æŠ¤ï¼šé˜Ÿåˆ—æ»¡æ—¶è‡ªåŠ¨æš‚åœè°ƒåº¦
> 
> è¿™ç¬¦åˆ**YAGNI åŸåˆ™**ï¼ˆYou Aren't Gonna Need Itï¼‰ã€‚"

### Q2: "å¦‚ä½•å¤„ç†åŒºå—é“¾é‡ç»„ï¼ˆReorgï¼‰ï¼Ÿ"

**å›ç­”**ï¼š
> "ç³»ç»Ÿé€šè¿‡ä»¥ä¸‹æœºåˆ¶å¤„ç† Reorgï¼š
> 1. **åˆ›ä¸–å“ˆå¸ŒéªŒè¯**ï¼šå¯åŠ¨æ—¶æ£€æµ‹é“¾æ˜¯å¦æ›´æ¢
> 2. **æ•°æ®åº“çº¦æŸ**ï¼šblocks è¡¨æœ‰å”¯ä¸€ç´¢å¼•ï¼ˆblock_number + hashï¼‰
> 3. **å›æ»šæœºåˆ¶**ï¼šæ£€æµ‹åˆ°é‡ç»„æ—¶ï¼Œåˆ é™¤åˆ†æ­§å—åé‡æ–°åŒæ­¥
> 
> åœ¨å½“å‰æ¼”ç¤ºä¸­ï¼ŒAnvil ç¯å¢ƒä¸å‘ç”Ÿ Reorgï¼Œä½†åœ¨ Sepolia æµ‹è¯•ç½‘å·²éªŒè¯è¯¥é€»è¾‘ã€‚"

### Q3: "å¦‚ä½•ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Ÿ"

**å›ç­”**ï¼š
> "é‡‡ç”¨**æ•°æ®åº“äº‹åŠ¡ + WALï¼ˆWrite-Ahead Loggingï¼‰**ï¼š
> 
> ```sql
> BEGIN;
>   INSERT INTO blocks (...) VALUES (...);
>   INSERT INTO transfers (...) VALUES (...);
>   UPDATE sync_checkpoints SET last_synced_block = ...;
> COMMIT;
> ```
> 
> å¦‚æœä»»ä½•æ­¥éª¤å¤±è´¥ï¼Œæ•´ä¸ªäº‹åŠ¡å›æ»šï¼Œä¿è¯**åŸå­æ€§**ã€‚
> 
> åŒæ—¶ï¼Œæˆ‘è¿˜æœ‰**æ•°æ®è´¨é‡æ£€æµ‹ SQL**ï¼ˆscripts/data-quality-check.sqlï¼‰ï¼š
> - å“ˆå¸Œè‡ªæŒ‡æ£€æµ‹
> - é“¾æ–­è£‚æ£€æµ‹
> - å­¤å„¿å—æ£€æµ‹
> - Gap æ£€æµ‹
> 
> åœ¨ç”Ÿäº§ç¯å¢ƒå¯ä»¥é€šè¿‡ cron å®šæœŸè¿è¡Œã€‚"

---

## ğŸ“Š æ¶æ„å›¾ï¼ˆå£å¤´æè¿°ï¼‰

> "ç³»ç»Ÿé‡‡ç”¨**äº‹ä»¶é©±åŠ¨æ¶æ„**ï¼ˆEvent-Driven Architectureï¼‰ï¼š
> 
> 1. **WebSocket Listener**ï¼šç›‘å¬æ–°åŒºå—äº‹ä»¶ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
> 2. **Height Oracle**ï¼šå®šæœŸè½®è¯¢é“¾é«˜åº¦ï¼ˆå…œåº•æœºåˆ¶ï¼‰
> 3. **Fetcher**ï¼šå¹¶å‘æŠ“å–åŒºå—ï¼ˆWorker Pool æ¨¡å¼ï¼‰
> 4. **Sequencer**ï¼šåºåˆ—åŒ–å¤„ç†ï¼ˆä¿è¯é¡ºåºï¼‰
> 5. **Metadata Enricher**ï¼šè¡¥å……å…ƒæ•°æ®ï¼ˆToken ä¿¡æ¯ç­‰ï¼‰
> 6. **AsyncWriter**ï¼šæ‰¹é‡å†™å…¥æ•°æ®åº“ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰
> 
> å„ç»„ä»¶é€šè¿‡ **Channel** è§£è€¦ï¼Œæ”¯æŒç‹¬ç«‹æ‰©å±•å’Œæ›¿æ¢ã€‚"

---

## ğŸ¯ æ”¶å°¾è¯æœ¯

> "æ€»ç»“ä¸€ä¸‹ï¼Œè¿™ä¸ªç³»ç»Ÿçš„æ ¸å¿ƒä¼˜åŠ¿ï¼š
> 
> 1. **é«˜å¯ç”¨**ï¼šæ­»é”è‡ªæ„ˆçœ‹é—¨ç‹—ï¼Œ120 ç§’å†…è‡ªåŠ¨æ¢å¤
> 2. **é«˜æ€§èƒ½**ï¼š16GB å†…å­˜ä¸‹ä¿æŒ 7.75 TPS å®šé¢‘è¾“å‡º
> 3. **é«˜å¯è§‚æµ‹**ï¼šPrometheus + Grafana + WebSocket å®æ—¶æ¨é€
> 4. **å·¥ç¨‹çºªå¾‹**ï¼šSmall Increments, Atomic Verificationï¼ˆä»Šå¤©çš„ 6 ä¸ªåŸå­æäº¤å°±æ˜¯è¯æ˜ï¼‰
> 
> è¿™æ˜¯ä¸€ä¸ª**ç”Ÿäº§å°±ç»ª**çš„ç´¢å¼•å™¨ï¼Œå·²ç»ä»æœ¬åœ° Anvil å¹³æ»‘è¿ç§»åˆ° Sepolia æµ‹è¯•ç½‘ï¼Œç´¢å¼•äº† 13,488 æ¡è½¬è´¦è®°å½•ã€‚
> 
> **ä¸‹ä¸€æ­¥**ï¼šä¸»ç½‘éƒ¨ç½²å’Œè·¨é“¾æ”¯æŒï¼ˆMulti-chainï¼‰ã€‚
> 
> è°¢è°¢ï¼"

---

## ğŸ”§ åº”æ€¥é¢„æ¡ˆ

### å¦‚æœæ¼”ç¤ºå¤±è´¥

1. **å®¹å™¨æœªå¯åŠ¨**ï¼š
   ```bash
   make a2
   ```

2. **UI æ— å“åº”**ï¼š
   ```bash
   docker logs web3-demo2-app --tail 50
   ```

3. **æ•°æ®åº“è¿æ¥å¤±è´¥**ï¼š
   ```bash
   docker ps | grep web3-indexer-db
   ```

4. **å®Œå…¨æ¢å¤**ï¼š
   ```bash
   git checkout v2.2.0-stable
   cp configs/env/config.demo.golden.env configs/env/.env.demo2
   make a2
   ```

---

## ğŸ“¦ æ¼”ç¤ºç¯å¢ƒè§„æ ¼

- **CPU**: ä»»æ„ï¼ˆæ¼”ç¤ºç”¨å•æ ¸å³å¯ï¼‰
- **å†…å­˜**: 16GBï¼ˆå®é™…ä½¿ç”¨ < 512MBï¼‰
- **ç£ç›˜**: 10GBï¼ˆæ•°æ®åº“ + æ—¥å¿—ï¼‰
- **ç½‘ç»œ**: æœ¬åœ° Anvilï¼ˆæ— å¤–ç½‘ä¾èµ–ï¼‰
- **ç«¯å£**: 8082ï¼ˆHTTP + WebSocketï¼‰

---

**ç‰ˆæœ¬**: v2.2.0-stable
**æ—¥æœŸ**: 2026-02-19
**ç»´æŠ¤è€…**: è¿½æ±‚ 6 ä¸ª 9 æŒä¹…æ€§çš„èµ„æ·±åç«¯å·¥ç¨‹å¸ˆ
