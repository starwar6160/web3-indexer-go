# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================
DATABASE_URL=postgres://postgres:postgres@localhost:15432/indexer?sslmode=disable

# ============================================================================
# RPC CONFIGURATION - Multi-Provider Support with Automatic Failover
# ============================================================================
# Sepolia Testnet (Recommended for development/testing)
# Format: RPC_URLS=https://provider1/...,https://provider2/...,https://provider3/...
RPC_URLS=https://eth-sepolia.g.alchemy.com/v2/YOUR_ALCHEMY_KEY,https://sepolia.infura.io/v3/YOUR_INFURA_KEY,https://rpc.sepolia.org

# WebSocket URL for real-time block monitoring (optional)
# WSS_URL=wss://eth-sepolia.g.alchemy.com/v2/YOUR_ALCHEMY_KEY

# Mainnet Configuration (for production)
# RPC_URLS=https://eth-mainnet.g.alchemy.com/v2/YOUR_ALCHEMY_KEY,https://mainnet.infura.io/v3/YOUR_INFURA_KEY

# ============================================================================
# CHAIN CONFIGURATION
# ============================================================================
# Sepolia Testnet
CHAIN_ID=11155111

# Mainnet
# CHAIN_ID=1

# ============================================================================
# SYNC CONFIGURATION
# ============================================================================
# Starting block for initial sync
# For Sepolia: Find contract deployment block on https://sepolia.etherscan.io
# Example: Sepolia USDC deployed at block ~5000000
START_BLOCK=5000000

# Batch size for block processing (adaptive based on network conditions)
# Smaller = more frequent DB updates but lower memory usage
# Larger = fewer DB updates but higher memory usage
BLOCK_BATCH_SIZE=1000

# Poll interval in milliseconds (Sepolia ~12s per block)
POLL_INTERVAL=12000

# Confirmation depth to prevent micro-reorgs
# Mainnet: 12-15 blocks
# Testnet: 2-6 blocks
CONFIRMATION_DEPTH=6

# ============================================================================
# CONTRACT CONFIGURATION (Optional - for specific token indexing)
# ============================================================================
# Sepolia USDC (example)
TOKEN_CONTRACT_ADDRESS=0x1c7D4B196Cb02324016f0dFb469597e730C0294C

# Sepolia WETH (example)
# TOKEN_CONTRACT_ADDRESS=0xfFf9976782d46CC05630D1f6eBAb6df1d78F9a33

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================
LOG_LEVEL=info
# Options: debug, info, warn, error

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================
# Max concurrent RPC requests (be careful with rate limits)
MAX_CONCURRENCY=10

# RPC request timeout in seconds
RPC_TIMEOUT=10

# Database connection pool settings
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=10

# ============================================================================
# SMART SLEEP CONFIGURATION - 智能休眠成本优化
# ============================================================================
# Demo mode duration in minutes (default: 5)
# After this period, indexer automatically returns to idle mode
DEMO_DURATION_MINUTES=5

# Idle timeout in minutes before entering watching mode (default: 10)
# If no API access for this period, switch to low-power WSS mode
IDLE_TIMEOUT_MINUTES=10

# Watchdog check interval in seconds (default: 60)
# How often the system checks for state transitions
CHECK_INTERVAL_SECONDS=60

# RPC timeout in seconds (for enhanced reliability)
RPC_TIMEOUT_SECONDS=10
